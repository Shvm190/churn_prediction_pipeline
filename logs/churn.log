python: can't open file '/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/dags/flow_prefect.py': [Errno 2] No such file or directory
18:37:21.903 | INFO    | prefect - Starting temporary server on http://127.0.0.1:8417
See https://docs.prefect.io/v3/concepts/server#how-to-guides for more information on running a dedicated Prefect server.
18:37:26.322 | INFO    | Flow run 'thistle-magpie' - Beginning flow run 'thistle-magpie' for flow 'churn-pipeline'
Traceback (most recent call last):
  File "/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/scripts/ingest.py", line 54, in <module>
    log_filename = f"{log_dir}/ingest_{datetime.now().strftime('%Y%m%d_%H%M%S')}.log"
NameError: name 'log_dir' is not defined
18:37:30.376 | ERROR   | Task run 'run_ingestion-3f2' - Task run failed with exception: CalledProcessError(1, ['python', 'scripts/ingest.py']) - No retries configured for this task.
Traceback (most recent call last):
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 869, in run_context
    yield self
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 1505, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 886, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/dags/perfect_dag.py", line 7, in run_ingestion
    subprocess.run(["python", "scripts/ingest.py"], check=True)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python', 'scripts/ingest.py']' returned non-zero exit status 1.
18:37:30.382 | ERROR   | Task run 'run_ingestion-3f2' - Finished in state Failed("Task run encountered an exception CalledProcessError: Command '['python', 'scripts/ingest.py']' returned non-zero exit status 1.")
18:37:30.382 | ERROR   | Flow run 'thistle-magpie' - Encountered exception during execution: CalledProcessError(1, ['python', 'scripts/ingest.py'])
Traceback (most recent call last):
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 782, in run_context
    yield self
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/dags/perfect_dag.py", line 47, in churn_pipeline
    run_ingestion()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 1732, in run_task
    return run_task_sync(**kwargs)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 1507, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 494, in result
    raise self._raised
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 869, in run_context
    yield self
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 1505, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 886, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/dags/perfect_dag.py", line 7, in run_ingestion
    subprocess.run(["python", "scripts/ingest.py"], check=True)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python', 'scripts/ingest.py']' returned non-zero exit status 1.
18:37:30.394 | INFO    | Flow run 'thistle-magpie' - Finished in state Failed("Flow run encountered an exception: CalledProcessError: Command '['python', 'scripts/ingest.py']' returned non-zero exit status 1.")
Traceback (most recent call last):
  File "/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/dags/perfect_dag.py", line 54, in <module>
    churn_pipeline()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flows.py", line 1702, in __call__
    return run_flow(
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 1399, in run_flow_sync
    return engine.state if return_type == "state" else engine.result()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 361, in result
    raise self._raised
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 782, in run_context
    yield self
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/flow_engine.py", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/dags/perfect_dag.py", line 47, in churn_pipeline
    run_ingestion()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 1732, in run_task
    return run_task_sync(**kwargs)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 1507, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 494, in result
    raise self._raised
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 869, in run_context
    yield self
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 1505, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/task_engine.py", line 886, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "/Users/homeaccount/PycharmProjects/dmml/churn_prediction_pipeline/dags/perfect_dag.py", line 7, in run_ingestion
    subprocess.run(["python", "scripts/ingest.py"], check=True)
  File "/Users/homeaccount/miniconda3/envs/prefect_env/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python', 'scripts/ingest.py']' returned non-zero exit status 1.
18:37:30.399 | INFO    | prefect - Stopping temporary server on http://127.0.0.1:8417
